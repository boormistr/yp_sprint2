Порядок инициализации шардирования:
1. Указание в compose-файле 16 различных контейнеров:

    Конфигуратор1,
    Конфигуратор2,
    Конфигуратор3,
    Роутер,
    Шард1a,
    Шард2a,
    Шард1b,
    Шард2b,
    Шард1c,
    Шард2c,
    Redis1,
    Redis2,
    Redis3,
    Redis4,
    Redis5,
    Redis6
2. Инициализация серверов конфигурации mongo
3. Инициализация шардов для каждой реплики mongo.
4. Инициализация роутера mongo
5. Инициализация кластера Redis:

    docker exec -it redis_1
    echo "yes" | redis-cli --cluster create   173.17.0.21:6379   173.17.0.22:6379   173.17.0.23:6379   173.17.0.24:6379   173.17.0.25:6379   173.17.0.26:6379   --cluster-replicas 1 